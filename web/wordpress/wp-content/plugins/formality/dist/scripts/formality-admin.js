/*! Formality v1.5.5 */!function(){"use strict";var __=wp.i18n.__;function e(e,n){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"==typeof e)return t(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return t(e,n)}(e))||n&&e&&"number"==typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,c=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return c=e.done,e},e:function(e){u=!0,a=e},f:function(){try{c||null==r.return||r.return()}finally{if(u)throw a}}}}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var n=wp.i18n.__,r=function(){var t,r,o,i,a,c,u,l=document.querySelector(".formality-export-toggle"),s=document.querySelector(".export-panel"),f=0,d=0;void 0!==s&&null!=s&&(t=s.querySelector("form"),r=t.querySelector(".export-result > a"),o=t.querySelector(".export-result > p"),i=t.querySelector(".progress > .bar"),u=t.querySelector(".export-cleanup > a"),l.addEventListener("click",(function(e){e.preventDefault(),s.classList.toggle("hidden")})),t.addEventListener("submit",(function(e){e.preventDefault(),y()})),t.addEventListener("input",(function(){m()})),u.addEventListener("click",(function(e){e.preventDefault();var t=u.getAttribute("href");fetch(t,{method:"get"}).then((function(e){r.setAttribute("href",""),r.setAttribute("download",""),r.innerText=""}))})));var m=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(e){var n=parseInt(document.querySelector('input[name="export_limit"]').value),r=parseInt(document.querySelector('input[name="export_skip"]').value),o=parseInt(document.querySelector('select[name="export_month"]').selectedOptions[0].getAttribute("data-results"));d=Math.max(Math.min(n,o-r),0)}var i=t?parseInt(f*d/t)-f:Math.max(1,parseInt(d/10));document.querySelector(".export-total-live").innerText=d,document.querySelector(".export-count-progress").innerText=t,document.querySelector(".export-time-remaining").innerText=i},p=function(e,t){f>10?(e.searchParams.get("resume")||e.searchParams.append("resume",1),h(e)):w(t)},v=function e(t){var n=new URL(t);n.searchParams.append("progress",1),fetch(n,{method:"get"}).then((function(e){if(e.ok)return e.json();throw""})).then((function(e){if("progress"in e){var t=parseInt(e.progress),n=Math.min(parseInt(100*t/d),100);i.style.width=n+"%",m(!1,t)}})).catch((function(e){})),a=setTimeout((function(){e(t)}),5e3)},y=function(){if(!t.classList.contains("loading")){r.innerText="",i.style.width="0%",t.classList.add("loading"),m();var n,o=new URL(t.getAttribute("action")),u=e(new FormData(t));try{for(u.s();!(n=u.n()).done;){var l=n.value;o.searchParams.append(l[0],l[1])}}catch(e){u.e(e)}finally{u.f()}a=setTimeout((function(){v(o)}),5e3),c=setInterval((function(){f++}),1e3),h(o)}},h=function(e){fetch(e,{method:"get"}).then((function(e){if(e.ok)return e.json();throw""})).then((function(e){"url"in e?g(e):w("error"in e?e.error:"")})).catch((function(t){p(e,t)}))},g=function(e){i.style.width="100%",document.querySelector(".export-count-progress").innerText=d,clearTimeout(a),clearInterval(c),f=0,setTimeout((function(){t.classList.remove("loading");var o=document.querySelector('input[name="export_filename"]').value;r.setAttribute("href",e.url),r.setAttribute("download",o?o+".csv":e.file),r.innerText=n("Download now","formality");var i=document.createEvent("MouseEvents");i.initEvent("click",!0,!0),r.dispatchEvent(i)}),800)},w=function(e){e=e||n("Something went wrong","formality"),i.style.width="0%",f=0,clearTimeout(a),clearInterval(c),setTimeout((function(){t.classList.remove("loading"),o.innerText=e}),800)}};document.addEventListener("DOMContentLoaded",(function(){!function(){var e=document.querySelectorAll(".formality-welcome-toggle");if(e.length){var t=document.querySelector(".welcome-panel");e.forEach((function(e){e.addEventListener("click",(function(n){n.preventDefault(),e.classList.toggle("close"),e.classList.add("loading"),t.classList.toggle("hidden"),fetch(e.href,{method:"get"}).then((function(t){e.classList.remove("loading")}))}))}))}}(),function(){var e=document.querySelector(".formality-newsletter");if(e){var t=e.querySelector('input[name="EMAIL"]'),n=e.querySelector(".formality-newsletter-result");e.addEventListener("submit",(function(r){if(r.preventDefault(),e.classList.contains("success"))return!1;var o=t.value,i=e.querySelector('input[name="gdpr[33536]"]').checked,a="";if(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(o))if(i){for(var c="mcsubscribe",u="//michelegiorgi.us14.list-manage.com/subscribe/post-json?u=faecff7416c1e26364c56ff3d&id=4f37f92e73",l="&c="+c,s=e.querySelectorAll("input"),f=0;f<s.length;f++)l+="&"+s[f].name+"="+encodeURIComponent(s[f].value);u+=l;var d=document.createElement("script");d.type="text/javascript",d.async=!0,d.src=u,window[c]=function(t){delete window[c],document.body.removeChild(d);var r=t.msg;n.innerHTML=r,("error"!==t.result||r.includes("already subscribed"))&&e.classList.add("success")},document.body.appendChild(d)}else a=__("To continue you have to accept our privacy policy","formality");else a=__("Please insert a valid email address","formality");a&&(n.innerText=a)}))}}(),r()}))}();